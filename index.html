<!DOCTYPE html>
<html lang="nl">

<head>
    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=AW-17574614935"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'AW-17574614935');
</script>

<!-- Meta Pixel Code -->
<script>
!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '1788618995199125');
fbq('track', 'PageView');
</script>
<noscript><img height="1" width="1" style="display:none"
src="https://www.facebook.com/tr?id=1788618995199125&ev=PageView&noscript=1"
/></noscript>
<!-- End Meta Pixel Code -->

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>stockflow: Gratis Voorraadbeheer</title>
  <link rel="icon" href="/favicon.ico" />
  <meta name="description" content="Ontdek hoe stockflow jou helpt bij het beheren van jouw voorraad, Effici√´nt en Gratis. Probeer het nu!" />
  <meta http-equiv="Content-Security-Policy" content="
    default-src 'self';
    connect-src 'self' https://sszuxnqhbxauvershuys.supabase.co wss://sszuxnqhbxauvershuys.supabase.co https://www.google-analytics.com https://region1.google-analytics.com https://www.google.com https://www.googletagmanager.com https://googleads.g.doubleclick.net https://www.googleadservices.com https://api.stripe.com https://checkout.stripe.com https://api.ipify.org https://translate.googleapis.com https://translate.google.com https://clients5.google.com *.google.com https://connect.facebook.net https://www.facebook.com;
    script-src 'self' 'unsafe-inline' https://www.googletagmanager.com https://www.googleadservices.com https://googleads.g.doubleclick.net https://www.google.com https://js.stripe.com https://translate.googleapis.com https://translate.google.com https://cdn.gtranslate.net https://clients5.google.com *.google.com https://connect.facebook.net;
    frame-src 'self' https://www.googletagmanager.com https://www.googleadservices.com https://googleads.g.doubleclick.net https://www.google.com https://td.doubleclick.net https://checkout.stripe.com https://js.stripe.com https://translate.googleapis.com https://translate.google.com https://clients5.google.com *.google.com;
    font-src 'self' https://fonts.gstatic.com https://fonts.googleapis.com;
    style-src 'self' 'unsafe-inline' https://fonts.googleapis.com;
    img-src 'self' data: https:;
  ">
  <!-- CSS Loading with fallback -->
  <link rel="stylesheet" href="/src/index.css" onerror="console.log('CSS loaded via Vite')">
  <link rel="stylesheet" href="/src/App.css" onerror="console.log('CSS loaded via Vite')">
  <style>
    /* Critical CSS: minimal layout voor snelle eerste render */
    html,body{min-height:100vh;margin:0;padding:0;width:100%;background:#fff;}
    #root{width:100vw;margin:0 auto;}
  </style>
</head>

<body>
  
  <div id="root"></div>
  
  <!-- Translation Solution -->
  <script type="text/javascript">
    // Translation implementation - page stays English until user chooses language
    (function() {
      'use strict';
      
      // Detect environment
      const isLocalhost = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';
      const isProduction = !isLocalhost && window.location.protocol === 'https:';
      
      console.log('üåê Translation System Initialized');
      console.log('üè† Is Localhost:', isLocalhost);
      console.log('üöÄ Is Production:', isProduction);
      console.log('üìÑ Page Language: English (default)');
      
      // Initialize translation system
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', () => {
          setTimeout(() => initializeTranslation(), 1000);
        });
      } else {
        setTimeout(() => initializeTranslation(), 1000);
      }
      
      // Initialize translation system
      function initializeTranslation() {
        console.log('üîß Initializing translation system...');
        
        if (isProduction) {
          console.log('üöÄ Loading Google Translate for production...');
          loadGoogleTranslate();
        } else {
          console.log('üè† Creating localhost translation widget...');
          createLocalhostTranslationWidget();
        }
      }
      
      // Load Google Translate for production
      function loadGoogleTranslate() {
        console.log('üì° Loading Google Translate script...');
        
        // Create Google Translate element
        const translateElement = document.createElement('div');
        translateElement.id = 'google_translate_element';
        translateElement.style.cssText = `
          position: fixed;
          top: 20px;
          right: 20px;
          z-index: 9999;
          background: white;
          border: 2px solid #007bff;
          border-radius: 8px;
          padding: 10px;
          box-shadow: 0 4px 12px rgba(0,0,0,0.15);
          font-family: Arial, sans-serif;
        `;
        document.body.appendChild(translateElement);
        
        // Load Google Translate script
        const script = document.createElement('script');
        script.src = 'https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit';
        script.onload = () => {
          console.log('‚úÖ Google Translate script loaded successfully');
        };
        script.onerror = (error) => {
          console.error('‚ùå Failed to load Google Translate:', error);
          // Fallback to localhost widget
          createLocalhostTranslationWidget();
        };
        
        // Add timeout for silent failures
        setTimeout(() => {
          if (!window.google || !window.google.translate) {
            console.error('‚è∞ Google Translate failed to load within timeout');
            createLocalhostTranslationWidget();
          }
        }, 5000);
        
        document.head.appendChild(script);
      }
      
      // Google Translate callback
      window.googleTranslateElementInit = function() {
        console.log('üîÑ Google Translate initialized');
        
        new google.translate.TranslateElement({
          pageLanguage: 'en',
          includedLanguages: 'nl,fr,de,es,it,pt,ru,ja,ko,zh,ar,hi,tr,pl,sv,da,no,fi,cs,hu,ro,bg,hr,sk,sl,et,lv,lt,mt,cy,ga,is,lb,eu,ca,gl',
          layout: google.translate.TranslateElement.InlineLayout.SIMPLE,
          autoDisplay: false
        }, 'google_translate_element');
        
        console.log('‚úÖ Google Translate element created');
        
        // Add event listener for language changes
        setTimeout(() => {
          const select = document.querySelector('.goog-te-combo');
          if (select) {
            console.log('üéØ Found language selector, adding event listener');
            select.addEventListener('change', handleLanguageChange);
          } else {
            console.error('‚ùå Language selector not found');
          }
        }, 1000);
      };
      
      // Handle language change from Google Translate
      function handleLanguageChange(event) {
        const selectedLang = event.target.value;
        console.log('üåç Language changed to:', selectedLang);
        
        if (selectedLang && selectedLang !== 'en') {
          console.log('üîÑ Triggering browser translation to:', selectedLang);
          triggerBrowserTranslation(selectedLang);
        }
      }
      
        
        document.body.appendChild(widget);
        
        // Add event listener
        const translateBtn = document.getElementById('translate-btn');
        const languageSelect = document.getElementById('language-select');
        
        translateBtn.addEventListener('click', () => {
          const selectedLang = languageSelect.value;
          console.log('üåç Localhost: Language selected:', selectedLang);
          
          if (selectedLang !== 'en') {
            console.log('üîÑ Localhost: Triggering browser translation to:', selectedLang);
            triggerBrowserTranslation(selectedLang);
          } else {
            console.log('üìÑ Localhost: English selected, no translation needed');
          }
        });
        
        console.log('‚úÖ Localhost translation widget created');
      }
      
      // Trigger automatic browser translation
      function triggerBrowserTranslation(targetLang) {
        console.log('üåê Starting automatic translation to:', targetLang);
        
        // Method 1: Direct Google Translate injection and auto-trigger
        console.log('üîß Injecting Google Translate for automatic translation...');
        injectAndTriggerGoogleTranslate(targetLang);
      }
      
      // Inject and automatically trigger Google Translate
      function injectAndTriggerGoogleTranslate(targetLang) {
        console.log('üîß Setting up automatic Google Translate for:', targetLang);
        
        // Remove any existing Google Translate elements
        const existingElements = document.querySelectorAll('[id*="google_translate"], .goog-te-banner-frame, .goog-te-menu-frame, .goog-te-gadget');
        existingElements.forEach(el => el.remove());
        
        // Create invisible Google Translate element
        const translateDiv = document.createElement('div');
        translateDiv.id = 'google_translate_element_auto';
        translateDiv.style.cssText = `
          position: absolute !important;
          top: -9999px !important;
          left: -9999px !important;
          width: 1px !important;
          height: 1px !important;
          opacity: 0 !important;
          pointer-events: none !important;
          z-index: -1 !important;
        `;
        document.body.appendChild(translateDiv);
        
        // Load Google Translate script
        if (!window.google || !window.google.translate) {
          console.log('üì° Loading Google Translate script...');
          
          const script = document.createElement('script');
          script.src = 'https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInitAuto';
          script.onload = () => {
            console.log('‚úÖ Google Translate script loaded');
          };
          script.onerror = () => {
            console.error('‚ùå Failed to load Google Translate script');
            // Fallback: redirect to Google Translate
            redirectToGoogleTranslate(targetLang);
          };
          document.head.appendChild(script);
          } else {
          console.log('‚úÖ Google Translate already loaded, initializing...');
          setTimeout(() => {
            autoTranslatePage(targetLang);
          }, 1000);
        }
      }
      
      // Google Translate auto-initialization
      window.googleTranslateElementInitAuto = function() {
        console.log('üîÑ Google Translate auto-initialization started');
        
        new google.translate.TranslateElement({
          pageLanguage: 'en',
          includedLanguages: 'nl,fr,de,es,it,pt,ru,ja,ko,zh,ar,hi,tr,pl,sv,da,no,fi,cs,hu,ro,bg,hr,sk,sl,et,lv,lt,mt,cy,ga,is,lb,eu,ca,gl',
          layout: google.translate.TranslateElement.InlineLayout.SIMPLE,
          autoDisplay: false,
          multilanguagePage: false
        }, 'google_translate_element_auto');
        
        // Wait for Google Translate to initialize and then auto-translate
        setTimeout(() => {
          console.log('‚è∞ Google Translate initialized, starting auto-translation...');
          autoTranslatePage(targetLang);
        }, 2000);
      };
      
      // Auto-translate the page
      function autoTranslatePage(targetLang) {
        console.log('üöÄ Auto-translating page to:', targetLang);
        
        // Try to find the Google Translate language selector
        const select = document.querySelector('.goog-te-combo');
        if (select) {
          console.log('üéØ Found Google Translate selector, setting language to:', targetLang);
          
          // Set the target language
          select.value = targetLang;
          
          // Trigger the change event to start translation
          const changeEvent = new Event('change', { bubbles: true });
          select.dispatchEvent(changeEvent);
          
          // Also try to click the translate button if it exists
          setTimeout(() => {
            const translateBtn = document.querySelector('.goog-te-menu-value span');
            if (translateBtn) {
              console.log('üéØ Clicking translate button');
              translateBtn.click();
            }
          }, 500);
          
          console.log('‚úÖ Auto-translation triggered for:', targetLang);
          
          // Hide the Google Translate banner after translation
          setTimeout(() => {
            hideGoogleTranslateBanner();
        }, 3000);
          
      } else {
          console.error('‚ùå Google Translate selector not found, using fallback');
          redirectToGoogleTranslate(targetLang);
        }
      }
      
      // Hide Google Translate banner
      function hideGoogleTranslateBanner() {
        console.log('üîß Hiding Google Translate banner...');
        
        // Hide the Google Translate banner
        const banner = document.querySelector('.goog-te-banner-frame');
        if (banner) {
          banner.style.display = 'none';
        }
        
        // Hide the Google Translate gadget
        const gadget = document.querySelector('.goog-te-gadget');
        if (gadget) {
          gadget.style.display = 'none';
        }
        
        console.log('‚úÖ Google Translate banner hidden');
      }
      
      // Fallback: redirect to Google Translate
      function redirectToGoogleTranslate(targetLang) {
        console.log('üîÑ Fallback: redirecting to Google Translate for:', targetLang);
        
        const currentUrl = window.location.href;
        const translateUrl = `https://translate.google.com/translate?sl=en&tl=${targetLang}&u=${encodeURIComponent(currentUrl)}`;
        
        console.log('üîó Redirecting to:', translateUrl);
        window.location.href = translateUrl;
      }
      
      
      // Manual translation trigger (for debugging)
      window.translateTo = function(targetLang) {
        console.log('üß™ Manual translation trigger to:', targetLang);
        triggerBrowserTranslation(targetLang);
      };
      
      // Debug function
      window.debugTranslation = function() {
        console.log('üîç Auto-Translation Debug Info');
        console.log('========================================');
        console.log('Environment:', isLocalhost ? 'Localhost' : 'Production');
        console.log('Google Translate loaded:', !!window.google?.translate);
        console.log('Auto translate element:', !!document.getElementById('google_translate_element_auto'));
        console.log('Language selector found:', !!document.querySelector('.goog-te-combo'));
        console.log('Translation widget:', !!document.getElementById('translation-widget'));
        console.log('Google Translate banner visible:', !!document.querySelector('.goog-te-banner-frame'));
        console.log('========================================');
      };
      
      // Test automatic translation
      window.testAutoTranslation = function(targetLang = 'nl') {
        console.log('üß™ Testing automatic translation to:', targetLang);
        triggerBrowserTranslation(targetLang);
      };
      
      // Show debug info
      console.log('üîß Automatic Translation System Ready');
      console.log('  - window.debugTranslation()        // Check translation status');
      console.log('  - window.translateTo("nl")         // Trigger automatic translation to Dutch');
      console.log('  - window.testAutoTranslation("fr") // Test automatic translation to French');
      
    })();
  </script>
  
  <script type="module" src="/src/main.tsx" defer></script>
</body>
</html>